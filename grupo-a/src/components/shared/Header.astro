---
import Navigation from './Navigation.astro';
import ThemeToggle from './ThemeToggle.astro';
import SearchBar from './SearchBar.astro';
import MobileMenu from './MobileMenu.astro';

// Obtener la URL base para enlaces
const BASE_URL = import.meta.env.BASE_URL || '/';
// Asegurarse de que termina con / para rutas relativas
const baseUrl = BASE_URL.endsWith('/') ? BASE_URL : `${BASE_URL}/`;
---

<header class="header" id="site-header">
  <div class="container header-container">
    <a href={baseUrl} class="logo" aria-label="Volver a inicio">
      <img src={`${baseUrl}images/logo.svg`} alt="Grupo A Logo" width="40" height="40" />
    </a>
    
    <Navigation />
    
    <div class="header-actions">
      <SearchBar />
      <ThemeToggle />
      <MobileMenu />
    </div>
  </div>
</header>

<script>
  // Efecto de scroll para el header
  document.addEventListener('DOMContentLoaded', () => {
    const header = document.getElementById('site-header');
    
    if (header) {
      // Verifica si ya hay scroll al cargar la página
      if (window.scrollY > 50) {
        header.classList.add('scrolled');
      }
      
      // Añade o quita la clase según el scroll
      window.addEventListener('scroll', () => {
        if (window.scrollY > 50) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
      });
    }
  });
</script>

<style>
  .header {
    background-color: var(--color-bg);
    border-bottom: 1px solid var(--color-gray-200);
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    transition: all var(--transition-normal, 0.3s ease);
  }

  .header.scrolled {
    background-color: rgba(var(--color-bg-rgb, 255, 255, 255), 0.8);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    box-shadow: var(--shadow-md, 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06));
  }

  .header-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-sm, 1rem);
    height: 4rem;
  }

  .logo {
    display: flex;
    align-items: center;
    transition: opacity var(--transition-fast, 0.2s ease);
  }
  
  .logo:hover {
    opacity: 0.8;
  }

  .logo img {
    width: 40px;
    height: 40px;
    object-fit: contain;
  }

  .header-actions {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm, 1rem);
  }

  @media (max-width: 768px) {
    .header-container {
      padding: 0.5rem var(--spacing-sm, 1rem);
    }
  }

  /* Fix para el contenido principal por el header fixed */
  :global(body) {
    padding-top: 4rem;
  }
</style>